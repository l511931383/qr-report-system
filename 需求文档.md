# 检测报告二维码系统开发需求文档

## 一、系统目标
1. 在检测报告首页生成可打印的二维码（尺寸：2cm×2cm）
2. 扫码后展示报告信息：
   - 报告名称、编号、检测单位
   - 检测员、批准人、检测时间、有效时间
3. 底部固定显示公司信息：
   - 公司名称、地址、联系电话、官网
4. 支持输入报告编号查询其他报告

## 二、技术方案选择（AI需使用以下技术）
| 模块          | 推荐方案              | 原因                 |
|---------------|-----------------------|----------------------|
| 前端页面      | HTML + CSS + JS       | 零成本，兼容移动端   |
| 后端服务      | Python Flask          | 简单轻量，适合小公司 |
| 数据库        | Airtable（免费版）    | 免运维，表格化管理   |
| 二维码生成    | QR Code Generator API | 免费基础版可用       |
| 服务器托管    | GitHub Pages          | 完全免费             |

## 三、分步开发指南

### 第1步：准备环境
1. 注册以下免费账号：
   - GitHub（用于托管代码）
   - Airtable（创建数据库）
   - QR Code Generator（https://goqr.me/api/）
2. 安装VSCode编辑器：https://code.visualstudio.com/

### 第2步：数据库配置（给AI的指令）
请在Airtable创建名为"检测报告"的Base，包含以下字段：
- 报告编号（主键，格式：REP-20231005-001）
- 报告名称
- 检测单位
- 检测员
- 批准人
- 检测时间（日期格式）
- 有效时间（日期格式）
- 生成时间（自动生成时间戳）

生成API访问凭证，提供：
1. Base ID
2. API Key
3. 表格名称

### 第3步：生成两个HTML文件
1. report.html：报告展示页面
   - 顶部显示二维码（调用QR Code API生成）
   - 表格展示报告信息
   - 底部固定显示公司信息
   - 包含"查询其他报告"按钮

2. query.html：报告查询页面
   - 输入框支持报告编号查询
   - 显示查询结果（样式同report.html）
   - 输入框下方显示编号示例：REP-YYYYMMDD-001

要求：
- 使用Bootstrap 5简化样式
- 移动端适配
- 通过URL参数传递报告编号，例如：
  report.html?number=REP-20231005-001

### 第4步：编写Python Flask程序
1. API路由：/get_report/<report_number>
   - 从Airtable查询数据
   - 返回JSON格式：
     {
       "status": "success/error",
       "data": {报告数据}
     }

2. 生成动态二维码：
   - 将报告访问链接生成二维码图片
   - 示例链接格式：https://[域名]/report.html?number=REP-20231005-001

需要包含：
- Airtable API连接配置
- 错误处理（无结果时返回404）
- CORS跨域配置

### 第5步：生成测试方案
1. 二维码测试：
   - 打印测试页扫描，验证信息准确性
   - 遮挡测试：二维码部分遮挡后能否识别

2. 查询功能测试：
   - 输入正确/错误/过期编号测试
   - 特殊字符输入测试

3. 压力测试：
   - 使用https://loader.io 进行50并发测试

### 第6步：生成分步部署指南
1. 前端部署：将HTML/CSS/JS上传至GitHub Pages
2. 后端部署：使用https://www.pythonanywhere.com 免费托管Flask应用
3. 域名配置（可选）：通过GitHub Pages绑定自定义域名

## 四、代码规范
1. 所有代码文件必须包含中文注释
2. 变量命名使用拼音全称，例如：baogaobianhao
3. 关键功能必须添加try-except错误处理

## 五、维护要求
1. 数据备份：每周导出Airtable数据为CSV
2. 日志记录：使用https://www.loggly.com 免费版记录错误
3. 更新流程：通过GitHub直接修改HTML文件

## 六、预算控制
| 项目          | 成本                                |
|---------------|-------------------------------------|
| 域名          | 免费（使用github.io子域名）         |
| 服务器        | 免费（PythonAnywhere + GitHub Pages）|
| 开发成本      | 0元（全程AI生成）                   |
| 维护成本      | 1小时/月（行政人员操作）            |
